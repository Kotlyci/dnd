(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var t="dnd-board-state",n=[{key:"todo",title:"To Do"},{key:"inprogress",title:"In Progress"},{key:"done",title:"Done"}];function r(e){localStorage.setItem(t,JSON.stringify(e))}var a,o=(a=localStorage.getItem(t))?JSON.parse(a):{todo:[],inprogress:[],done:[]},l=null,c=null;function i(){var t=document.getElementById("app");t.innerHTML="";var a=document.createElement("div");a.className="board",n.forEach(function(t){var n=document.createElement("div");n.className="column",n.dataset.column=t.key;var d=document.createElement("div");d.className="column-title",d.textContent=t.title,n.append(d);var u=document.createElement("div");u.className="cards",u.addEventListener("dragover",function(e){e.preventDefault(),l&&(u.querySelector(".placeholder")||u.append(c))}),u.addEventListener("drop",function(n){if(n.preventDefault(),l){var a=Array.from(u.children).indexOf(c);-1===a&&(a=o[t.key].length);var d=function(t,n){return function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,c=[],i=!0,d=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(e){d=!0,a=e}finally{try{if(!i&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(d)throw a}}return c}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o[l.fromCol].splice(l.fromIdx,1),1)[0];o[t.key].splice(a,0,d),r(o),l=null,c=null,i()}}),u.addEventListener("dragleave",function(e){e.relatedTarget&&!u.contains(e.relatedTarget)&&c&&u.contains(c)&&u.removeChild(c)}),o[t.key].forEach(function(e,n){var a=function(e,t,n){var a=document.createElement("div");a.className="card",a.draggable=!0,a.textContent=e.text;var d=document.createElement("span");return d.className="delete-btn",d.textContent="×",d.onclick=function(e){e.stopPropagation(),o[t].splice(n,1),r(o),i()},a.append(d),a.addEventListener("dragstart",function(e){l={fromCol:t,fromIdx:n},setTimeout(function(){return a.classList.add("dragging")},0),(c=document.createElement("div")).className="card placeholder",c.style.height="".concat(a.offsetHeight,"px")}),a.addEventListener("dragend",function(){a.classList.remove("dragging"),l=null,c=null,i()}),a}(e,t.key,n);a.addEventListener("dragover",function(e){if(e.preventDefault(),l){var t=a.getBoundingClientRect(),n=e.clientY-t.top<t.height/2;u.querySelectorAll(".placeholder").forEach(function(e){return e.remove()}),n?u.insertBefore(c,a):u.insertBefore(c,a.nextSibling)}}),u.append(a)}),n.append(u);var s=document.createElement("button");s.className="add-btn",s.textContent="Add another card",s.onclick=function(){s.style.display="none";var e=document.createElement("div");e.className="add-card-form";var a=document.createElement("input");a.type="text",a.placeholder="Card text";var l=document.createElement("button");l.textContent="Добавить",l.onclick=function(){a.value.trim()&&(o[t.key].push({text:a.value.trim()}),r(o),i())},e.append(a),e.append(l),n.append(e),a.focus()},n.append(s),a.append(n)}),t.append(a)}document.addEventListener("DOMContentLoaded",function(){i()})})();